USE ROLE SS_DBA;

CREATE
OR REPLACE PIPE SS_DEV.RAW.CHARACTERISTICS_PIPE 
AUTO_INGEST = TRUE 
INTEGRATION = 'STATESTREET_INTEGRATION' 
AS COPY INTO CHARACTERISTICS
  (
    ANALYTICS_SOURCE,
    EFFECTIVE_DATE,
    AVG_LIFE,
    BETA_FUND,
    BETA_PRICE,
    BUY_HOLD_DLY_RT,
    BUY_HOLD_MNTH_RT,
    COMM_SHRS_OUT,
    CONVEXITY,
    COUPON,
    CURR_ASSETS_TOT,
    CURR_LIAB_TOT,
    CURR_YLD,
    DEBT_CAP_RATIO,
    DIV_YLD,
    DIV_YLD_5_YR_GRWTH,
    DUR_MOD,
    DUR_OPT_ADJ,
    EBS_5_YR_GRWTH_IBES,
    EBS_5_YR_STAB,
    EPS,
    EPS_5_YR_GRWTH,
    EPS_CHNG_12_MTHS,
    EPS_FISC_1_YR_EST,
    EPS_FISC_2_YR_EST,
    EPS_GRWTH_4_YR,
    EPS_TR_12_MTH,
    FISCAL_YR,
    FORWARD_PE,
    LT_DEBT_TO_ASSETS,
    LT_DEBT_TO_EQTY,
    MKT_CAP,
    MKT_CAP_480,
    MOODY_RATING,
    MOODY_VENDED_RATING,
    NET_INC_LOSS,
    NET_PROF_MG,
    NET_SALES,
    OAS,
    PAYOUT_RATIO,
    PE,
    PE_WO_NEGATIVE,
    PRC_EPS_FY1_EST_IBES,
    PRICE_TO_BOOK,
    PRICE_TO_CASH_FL,
    PRICE_TO_EBITDA,
    PRICE_TO_SALES,
    QUICK_RATIO,
    ROA,
    ROE,
    ASSET_IDENTIFIER,
    LOC_CURRENCY,
    SH_HOLDER_EQ,
    SP_RATING,
    SP_VENDED_RATING,
    STD_4_YR_EPS_GRWTH,
    STD_5_YR_YLD_AVG,
    STD_BK_PRICE_RATIO,
    STD_ER_PRICE_RATIO,
    STD_LT_DEBT_ASSETS_RATIO,
    STD_NAT_LOG_MKT_CAP,
    TIME_TO_MAT,
    TOTAL_ASSETS,
    TOTAL_DEBT,
    YLD_AVG_5_YR,
    YTM,
    YTM_OR_CALL,
    SOURCE_FILENAME,
    SOURCE_FILE_ROW_NUMBER
  )
FROM
  (
    SELECT
      T.$1,
      T.$2,
      T.$3,
      T.$4,
      T.$5,
      T.$6,
      T.$7,
      T.$8,
      T.$9,
      T.$10,
      T.$11,
      T.$12,
      T.$13,
      T.$14,
      T.$15,
      T.$16,
      T.$17,
      T.$18,
      T.$19,
      T.$20,
      T.$21,
      T.$22,
      T.$23,
      T.$24,
      T.$25,
      T.$26,
      T.$27,
      T.$28,
      T.$29,
      T.$30,
      T.$31,
      T.$32,
      T.$33,
      T.$34,
      T.$35,
      T.$36,
      T.$37,
      T.$38,
      T.$39,
      T.$40,
      T.$41,
      T.$42,
      T.$43,
      T.$44,
      T.$45,
      T.$46,
      T.$47,
      T.$48,
      T.$49,
      T.$50,
      T.$51,
      T.$52,
      T.$53,
      T.$54,
      T.$55,
      T.$56,
      T.$57,
      T.$58,
      T.$59,
      T.$60,
      T.$61,
      T.$62,
      T.$63,
      T.$64,
      T.$65,
      T.$66,
      T.$67,
      METADATA$FILENAME,
      METADATA$FILE_ROW_NUMBER
    FROM
      @STATESTREET_AZURE_STAGE_CHARACTERISTICS (FILE_FORMAT => SS_FILEFORMAT_CSV) T
  );